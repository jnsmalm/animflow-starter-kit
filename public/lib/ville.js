!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("VILLE",[],t):"object"==typeof exports?exports.VILLE=t():e.VILLE=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r=[];t.task=function(e){return r[r.length-1].add(e)},t.get_tasks=function(e){let t=[];return r.push({add:e=>(t.push(e),e)}),e(),r.pop(),t},t.have_task_manager=function(){return r.length>0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),o=n(0);t.sequence=function(e){let t=!1,n=!1,i=function*(){let r=o.get_tasks(e);for(let e of r){if(n)return void(t=!0);for(let r of e()){if(n)return void(t=!0);yield}}t=!0};return o.have_task_manager()?o.task(function*(){yield*i()}):r.thread(function*(){yield*i()}),{cancel:function(){o.task(function*(){n=!0})},completed:function(){return t}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(7),o=n(0),i=n(3);function u(e,t,n,r){return e+(t-e)*r(n)}t.tween=function(e){let t=i.ease.linear,n={},c=0;return o.task(function*(){let o={};for(let t in n)o[t]=e[t];let i=0;for(;i<c&&c>0;){i+=r.time();let s=Math.min(1,i/c);for(let r in o)e[r]=u(o[r],n[r],s,t);yield}for(let t in o)e[t]=n[t]}),{to:function(e){return n=e,this},ease:function(e=i.ease.sine_inout){return t=e,this},time:function(e){return c=e,this}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.linear=function(e){return e},e.sine_in=function(e){return-1*Math.cos(e*(Math.PI/2))+1},e.sine_inout=function(e){return-.5*(Math.cos(Math.PI*e)-1)},e.sine_out=function(e){return Math.sin(e*(Math.PI/2))}}(t.ease||(t.ease={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r=[],o=[],i=0;function u(e){e.sort((e,t)=>e.priority===t.priority?t.id-e.id:t.priority-e.priority);for(let t=e.length-1;t>=0;t--)(e[t].cancel||e[t].job.next().done)&&e.splice(t,1)}t.thread=function(e){if("function"!=typeof e)throw new TypeError("A thread only acceps a 'generator function' as an argument");let t=e();if(!t||!t.next)throw new TypeError("A thread only acceps a 'generator function' as an argument");let n={job:t,priority:0,id:i++,cancel:!1};return o.push(n),{cancel:function(){n.cancel=!0},priority:function(e){return n.priority=e,this}}},t.run_threads=function(){if(o.length>0){for(let e=0;e<o.length;e++)r.push(o[e]);o=[]}u(r),u(o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1);let o,i;t.game={load:e=>{fetch("assets.json").then(e=>{if(e.ok)return e.json()}).then(n=>{Object.assign(t.game,n);for(let e in n)PIXI.loader.add(e,n[e]);PIXI.loader.load(()=>{e&&r.sequence(e)})})},render:()=>{o&&o.render(i)},init:(e=800,t=600,n=!0)=>{if(o=PIXI.autoDetectRenderer({width:e,height:t}),i=new PIXI.Container,document.body.appendChild(o.view),n){let n=()=>{o.resize(window.innerWidth,window.innerHeight),i.position.set(window.innerWidth/2,window.innerHeight/2),i.scale.set(Math.min(window.innerWidth/e,window.innerHeight/t))};window.onresize=n,n()}},stage:()=>i,renderer:()=>o}},function(e,t,n){"use strict";function r(e=0,t=0){return{x:e,y:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.vector=r,r.add=((e,t)=>r(e.x+t.x,e.y+t.y)),r.sub=((e,t)=>r(e.x-t.x,e.y-t.y)),r.dot=((e,t)=>e.x*t.x+e.y*t.y),r.mul=((e,t)=>r(e.x*t,e.y*t)),r.neg=(e=>r(-1*e.x,-1*e.y)),r.normalize=(e=>{let t=r.len(e);return r(e.x/t,e.y/t)}),r.len=(e=>Math.sqrt(e.x*e.x+e.y*e.y))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),o=n(4);t.time=function(){return u/1e3};let i=0,u=0;requestAnimationFrame(function e(t){u=t-i,i=t,o.run_threads(),r.game.render(),requestAnimationFrame(e)})},function(e,t,n){"use strict";n.r(t),n.d(t,"repeat",function(){return o});var r=n(0);function o(e){let t=!1,n=Number.MAX_VALUE,o=!1;return Object(r.task)(function*(){for(let i=0;i<n;i++){if(o)return void(t=!0);let n=Object(r.get_tasks)(e);for(let e of n)yield*e();yield}t=!0}),{cancel:function(){Object(r.task)(function*(){o=!0})},completed:function(){return t},times:function(e){n=e}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7);t.time=r.time;var o=n(4);t.thread=o.thread;var i=n(5);t.game=i.game;var u=n(10);t.sprite=u.sprite;var c=n(11);t.text=c.text;var s=n(12);t.remove=s.remove;var a=n(13);t.key=a.key;var l=n(14);t.collision=l.collision;var f=n(18);t.wait=f.wait;var d=n(0);t.task=d.task;var p=n(1);t.sequence=p.sequence;var h=n(19);t.parallel=h.parallel;var v=n(2);t.tween=v.tween;var y=n(3);t.ease=y.ease;var b=n(20);t.move=b.move;var m=n(21);t.rotate=m.rotate;var w=n(22);t.scale=w.scale;var j=n(23);t.show=j.show;var g=n(24);t.hide=g.hide;var O=n(25);t.sound=O.sound;var _=n(26);t.proceed=_.proceed;var x=n(8);t.repeat=x.repeat},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),o=n(0);t.sprite=function(e,t){let n;return(n=e?PIXI.Sprite.from(e):new PIXI.Sprite).anchor.set(.5),o.task(function*(){t||(t=r.game.stage()),t.addChild(n)}),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),o=n(0);t.text=function(e,t){let n=new PIXI.Text(e,{fontFamily:"Helvetica",fontSize:36,fill:16777215,align:"center"});return n.anchor.set(.5),o.task(function*(){t||(t=r.game.stage()),t.addChild(n)}),n}},function(e,t,n){"use strict";n.r(t),n.d(t,"remove",function(){return o});var r=n(0);function o(e){Object(r.task)(function*(){e.parent&&e.parent.removeChild(e)})}},function(e,t,n){"use strict";n.r(t),n.d(t,"key",function(){return u});var r=n(0),o=n(1),i=n(8);function u(e){return{down:t=>{let n;return Object(r.task)(function*(){n=s(e,"down",t)}),{cancel:()=>{Object(r.task)(function*(){a(e,"down",n)})}}},up:t=>{let n;return Object(r.task)(function*(){n=s(e,"up",t)}),{cancel:()=>{Object(r.task)(function*(){a(e,"up",n)})}}},repeat:t=>{let n,o,u;return Object(r.task)(function*(){n=s(e,"down",()=>{u=Object(i.repeat)(t)}),o=s(e,"up",()=>{u&&u.cancel()})}),{cancel:()=>{u&&u.cancel(),Object(r.task)(function*(){a(e,"down",n),a(e,"up",o)})}}}}}let c={down:{},up:{}};function s(e,t,n){let r;e=e.toLowerCase(),c[t][e]||(c[t][e]=[]);let i=()=>{r&&!r.completed()||(r=Object(o.sequence)(n))};return c[t][e].push(i),i}function a(e,t,n){if(e=e.toLowerCase(),!c[t][e])return;let r=c[t][e].indexOf(n);c[t][e].splice(r,1)}document.addEventListener("keydown",e=>{let t=e.key.toLowerCase();c.down[t]&&0!==c.down[t].length&&c.down[t].slice(-1)[0]()}),document.addEventListener("keyup",e=>{let t=e.key.toLowerCase();c.up[t]&&0!==c.up[t].length&&c.up[t].slice(-1)[0]()})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(15),o=n(6),i=n(16),u=n(17),c=n(0);function s(e,t){return"aabb"===e.type()&&"aabb"===t.type()?function(e,t){let n=[o.vector(0,1),o.vector(1,0)];return r.sat(e,t,n)}(e,t):"sphere"===e.type()&&"sphere"===t.type()?function(e,t){let n=[o.vector.normalize(o.vector.sub(e.center(),t.center()))];return r.sat(e,t,n)}(e,t):void 0}function a(e,t){if(e&&t)for(let n=0;n<e.length;n++)for(let r=e===t?n+1:0;r<t.length;r++){if(e[n]===t[r])continue;let i=s(e[n],t[r]);i&&(e[n].collision(i,t[r].object),t[r].collision(o.vector.neg(i),e[n].object))}}t.collision=function(){let e={"":[]};return{aabb:t=>{let n,r=i.aabb(t),o="",u={type:()=>"aabb",collision:(e,t)=>{n&&n(e,t)},object:()=>t,center:()=>r.center(),points:()=>r.points(),radius:()=>0};return e[o].push(u),{group:function(t){return c.task(function*(){e[o].splice(e[o].indexOf(u),1),e[o=t]||(e[o]=[]),e[o].push(u)}),this},show:function(){return r.show(),this},size:function(e,t){return r.size(e,t),this},handle:function(e){return n=e,this}}},sphere:t=>{let n,r=u.sphere(t),o="",i={type:()=>"sphere",collision:(e,t)=>{n&&n(e,t)},object:()=>t,center:()=>r.center(),points:()=>r.points(),radius:()=>r.radius()||0};return e[o].push(i),{group:function(t){return c.task(function*(){e[o].splice(e[o].indexOf(i),1),e[o=t]||(e[o]=[]),e[o].push(i)}),this},show:function(){return r.show(),this},size:function(e){return r.size(e),this},handle:function(e){return n=e,this}}},detect:(t=[{a:"",b:""}])=>{c.task(function*(){for(let n of t)a(e[n.a],e[n.b])})}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6);function o(e,t){let n=e.points(),o=e.radius(),u=r.vector.dot(n[0],t),c=u,s=u;for(let e=1;e<n.length;e++)u=r.vector.dot(n[e],t),c=Math.min(u,c),s=Math.max(u,s);return new i(c-o,s+o)}class i{constructor(e,t){this.min=e,this.max=t}overlap(e){return this.min<e.min?e.min-this.max:this.min-e.max}}t.sat=function(e,t,n){let i=Number.MAX_VALUE,u=r.vector();for(let r of n){let n=o(e,r),c=o(t,r);if(n.overlap(c)>=0)return;Math.abs(n.overlap(c))<i&&(i=Math.abs(n.overlap(c)),u=r)}let c=r.vector.sub(e.center(),t.center());return r.vector.dot(c,u)<0&&(u=r.vector.neg(u)),r.vector.mul(u,i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6),o=n(0);t.aabb=function(e){let t,n,i,u=!1;function c(){let r;i&&e.removeChild(i),r=t&&n?new PIXI.Rectangle(t/-2,n/-2,t,n):e.getLocalBounds(),(i=new PIXI.Graphics(!0)).visible=u,i.lineStyle(u?1e-4:0,16711680,.8),i.moveTo(r.left,r.top).lineTo(r.right,r.top).lineTo(r.right,r.bottom).lineTo(r.left,r.bottom).lineTo(r.left,r.top),e.addChild(i)}return c(),{points:()=>{let e=i.getBounds();return[r.vector(e.left,e.top),r.vector(e.right,e.bottom),r.vector(e.right,e.top),r.vector(e.left,e.bottom)]},size:function(e,r){t=e,n=r,o.task(function*(){c()})},show:function(){u=!0,o.task(function*(){c()})},center:function(){let{x:t,y:n}=e.getGlobalPosition();return r.vector(t,n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6),o=n(0);t.sphere=function(e){let t,n,i=!1;function u(){n&&e.removeChild(n);let r=t;r||(r=e.getLocalBounds().width/2),(n=new PIXI.Graphics(!0)).visible=i,n.lineStyle(i?1e-4:0,16711680,.8),n.drawCircle(0,0,r),e.addChild(n)}return u(),{points:function(){return[this.center()]},size:function(e){t=e,o.task(function*(){u()})},radius:function(){return n.getBounds().width/2},show:function(){i=!0,o.task(function*(){u()})},center:function(){let{x:t,y:n}=e.getGlobalPosition();return r.vector(t,n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(7);t.wait=function(e=Number.MAX_VALUE){let t=!1;return r.task(function*(){let n=0;for(;n<e&&!t;)n+=o.time(),yield}),{cancel:()=>{r.task(function*(){t=!0})}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"parallel",function(){return i});var r=n(4),o=n(0);function i(e){let t=!1,n=!1,i=function*(){let r=Object(o.get_tasks)(e);r.reverse();for(let e=0;e<r.length;e++)r[e]=r[e]();for(;r.length>0;){for(let e=r.length-1;e>=0;e--){if(n)return void(t=!0);r[e].next().done&&r.splice(e,1)}yield}t=!0};return Object(o.have_task_manager)()?Object(o.task)(function*(){yield*i()}):Object(r.thread)(function*(){yield*i()}),{cancel:()=>{Object(o.task)(function*(){n=!0})},completed:()=>t}}},function(e,t,n){"use strict";n.r(t),n.d(t,"move",function(){return u});var r=n(2),o=n(1),i=n(3);function u(e){let t={},n={},u=i.ease.linear,c=0;return Object(o.sequence)(()=>{void 0===t.x&&void 0===t.y?(void 0!==n.x&&(n.x+=e.x),void 0!==n.y&&(n.y+=e.y),Object(r.tween)(e).to(n).time(c).ease(u)):Object(r.tween)(e).to(t).time(c).ease(u)}),{to:function(e){return void 0!==e.x&&(t.x=e.x),void 0!==e.y&&(t.y=e.y),this},by:function(e){return void 0!==e.x&&(n.x=e.x),void 0!==e.y&&(n.y=e.y),this},ease:function(e=i.ease.sine_inout){return u=e,this},time:function(e){return c=e,this}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"rotate",function(){return c});var r=n(2),o=n(1),i=n(3);const u=2*Math.PI/360;function c(e){let t,n,c=i.ease.linear,s=0;return Object(o.sequence)(()=>{let o=e.rotation;void 0!==n&&(o=e.rotation+n*u),void 0!==t&&(o=t*u),Object(r.tween)(e).to({rotation:o}).time(s).ease(c)}),{to:function(e){return t=e,this},by:function(e){return n=e,this},ease:function(e=i.ease.sine_inout){return c=e,this},time:function(e){return s=e,this}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"scale",function(){return u});var r=n(2),o=n(1),i=n(3);function u(e){let t={},n={},u=i.ease.linear,c=0;return Object(o.sequence)(()=>{void 0===t.x&&void 0===t.y?(void 0!==n.x&&(n.x+=e.scale.x),void 0!==n.y&&(n.y+=e.scale.y),Object(r.tween)(e.scale).to(n).time(c).ease(u)):Object(r.tween)(e.scale).to(t).time(c).ease(u)}),{to:function(e){return"number"==typeof e?(t.x=e,t.y=e):(void 0!==e.x&&(t.x=e.x),void 0!==e.y&&(t.y=e.y)),this},by:function(e){return"number"==typeof e?(n.x=e,n.y=e):(void 0!==e.x&&(n.x=e.x),void 0!==e.y&&(n.y=e.y)),this},ease:function(e=i.ease.sine_inout){return u=e,this},time:function(e){return c=e,this}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"show",function(){return i});var r=n(2),o=n(1);function i(e){let t=0;return Object(o.sequence)(()=>{Object(r.tween)(e).to({alpha:1}).time(t)}),{time:function(e){t=e}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"hide",function(){return i});var r=n(2),o=n(1);function i(e){let t=0;return Object(o.sequence)(()=>{Object(r.tween)(e).to({alpha:0}).time(t)}),{time:function(e){t=e}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"sound",function(){return o});var r=n(0);function o(e){let t=!1;return Object(r.task)(function*(){let n=new Audio(e);n.onended=(()=>{t=!0}),n.play()}),{wait:function(){Object(r.task)(function*(){for(;!t;)yield})}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"proceed",function(){return i});var r=n(0),o=n(4);function i(e){let t,n=!1,i=0;return Object(r.task)(function*(){n||(t=Object(o.thread)(function*(){let t=Object(r.get_tasks)(e);for(let e of t)yield*e()})).priority(i)}),{cancel:function(){t&&t.cancel(),n=!0},priority:function(e){return t&&t.priority(e),i=e,this}}}}])});